const tap = require('tap')
const Application = require('spectron').Application

const path = require('path')
const fs = require('fs')
const request = require('request')
const readChunk = require('read-chunk')
const fileType = require('file-type')

const PORT = 9109
const SERVER_URL = `http://localhost:${PORT}`
const ROOT_PATH = path.join(__dirname, '..', '..')

const app = new Application({
  path: path.join(ROOT_PATH, 'bin', 'plotly-export-server.js'),
  args: ['--port', PORT]
})

tap.tearDown(() => {
  if (app && app.isRunning()) {
    app.stop()
  }
})

tap.test('should launch', t => {
  app.start().then(() => {
    app.client.getWindowCount().then(cnt => {
      t.end()
    })
  })
})

const ebola1 = {
  'data': [
    {
      'autobinx': true,
      'autobiny': true,
      'cells': {
        'fill': {
          'color': 'rgb(242, 245, 250)'
        },
        'height': 28,
        'line': {
          'color': 'rgb(200, 212, 227)',
          'width': 1
        },
        'values': [
          [
            '30km from Yambuku',
            '\'\'Ngaliema hospital, Kinshasa\'\'',
            '120km from Yambuku (Bumba Zone 55/250 villages affected)',
            'Yambuku village (secondary)',
            'Yambuku village (index)',
            'Khartoum hospital',
            'Omdurman hospital',
            'Nzara (Cotton Factory)',
            'Juba hospital',
            'Maridi township',
            'Maridi General Hospital',
            'Nzara township',
            'Nzara hospital',
            'Tembura (Tambura in GMs)',
            'Bonduni village (20km east of Tanda)',
            'Nzara town',
            'Nzara hospital',
            '15km radius around Nzara',
            '15km radius around Yambio',
            'Tai National Park',
            'Mayela',
            'Ekobakoba',
            'Makokou general hospital',
            'Etakaniabe',
            'Andock',
            'Mekouka',
            'Mekouka and Andock mining camps',
            'Minkebe',
            'Mwembe (15km from Kikwit)',
            'Kikwit',
            'Kikwit 2 maternity hospital',
            'Kikwit general hospital',
            'Kikwit subregion',
            'Mosango hospital',
            'Mosango town',
            '150km from Kikwit within Kwilu district',
            '150km from Kikwit within Kwango district',
            'Kinshasa hospital',
            'Makokou general hospital',
            'Mayibout 2 (index)',
            'Mayibout 2 (secondary)',
            'Logging camp nr Booue (index 1)',
            'Logging camp nr Booue (index 2)',
            'Logging camp nr Booue (index 3)',
            'Balimba village (sp. Balemba in GE)',
            'Booue',
            'Around Booue',
            'Libreville',
            'Johannesburg (South Africa)',
            'Lastourville',
            'Makokou general hospital',
            'Gulu regional referral hospital',
            'Masindi hospital',
            'Lacor Hospital',
            'Mbarara hospital',
            'Mbarara district',
            'Rwot-Obilo',
            'Masindi district',
            'Gulu district',
            '\'\'Franceville, Mpassa district, Gabon\'\'',
            'Mbomo district (ROC)',
            '\'\'Ivindo Department, Gabon\'\'',
            '\'\'Zadie Department, Gabon\'\'',
            '\'\'Makokou Regional Hopsital, Ivindo district, Gabon\'\'',
            '\'\'Mekambo health center, La Zadie district, Gabon\'\'',
            'Kelle district (ROC)',
            'Etakangaye',
            '\'\'Oloba, Mbomo district\'\'',
            'Ekata',
            '\'\'Entsiami, Abolo, Ambomi\'\'',
            'Memdemba',
            'Grand Etoumbi',
            'Mbomo district',
            'Kelle health district',
            'Kelle health center',
            'Entsiami health center',
            '\'\'Site 2  (Kullu district, Cuvette Ouest)\'\'',
            '\'\'Yembelangoye village (Kullu district, Cuvette Ouest)\'\'',
            '\'\'Mvoula camp (Kullu district, Cuvette Ouest)\'\'',
            '\'\'Mbandza forest near village (Mbomo district, Cuvette Ouest)\'\'',
            'Mbandza village',
            'Mbomo village',
            'Yambio county',
            'Forest 40km South of Yambio town',
            'Yambio town',
            'Mbomo',
            'Odzala National Park (Etoumbi)',
            'Etoumbi',
            'Bamoukamba 2 (index)',
            'Bamoukamba 2 (secondary)',
            'Ndongo 2',
            'From Ndongo 2 to Kampungu',
            'Luebo health zone',
            'Mweka health zone',
            'Karugutu subcountry',
            'Bubandi subcountry',
            'Busaru subcountry',
            'Bubukwanga subcountry (sp. Bukwanga in GE)',
            'Harugali subcountry',
            'Kasitu subcountry',
            'Kabango village (secondary)',
            '\'\'Kabango village (Kasitu subcounty, Bundibugyo district) (index)\'\'',
            'Bundibungyo town council subcountry',
            'Luebo health zone (index)',
            'Luebo health zone (secondary)',
            'Mweka health zone',
            'Nakisamata village (Luwero District)',
            'Kibaale district',
            '\'\'Nyanswiga village, Nyamarunda, Buyanja  (Kibaale District) (index)\'\'',
            'Nyanswiga village (secondary)',
            'Isiro health zone (index)',
            'Isiro health zone (secondary)',
            'Viadana health zone',
            'Luwero district (secondary)',
            'Jinja district',
            'Luwero district (index)',
            'Nakasongola district'
          ],
          [
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Zaire',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Ivory Coast',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Zaire',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Bundibugyo',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan',
            'Ebola Sudan'
          ],
          [
            2.82536,
            -4.31464,
            2.82547,
            2.82535,
            2.82535,
            15.56667,
            15.64228,
            4.63912,
            4.82768,
            4.91599,
            4.91599,
            4.63912,
            4.64247,
            5.60639,
            2.88874,
            4.639,
            4.639,
            4.63912,
            4.57757,
            5.86442,
            0.61618,
            0.56329,
            0.56667,
            0.53304,
            1.483,
            1.4,
            1.44201,
            1.76667,
            -5.03334,
            -5.03333,
            -5.03333,
            -5.03333,
            -4.60873,
            -4.88687,
            -4.88687,
            -4.93064,
            -5.88291,
            -4.30889,
            0.56667,
            1.11667,
            1.11667,
            0.1,
            0.1,
            0.1,
            0.11667,
            -0.09363,
            -0.09363,
            0.39478,
            -26.17673,
            -0.81832,
            0.56667,
            2.77768,
            1.68537,
            2.76761,
            -0.61158,
            -0.56762,
            2.94998,
            1.74679,
            2.83664,
            -1.63333,
            0.59709,
            0.66543,
            0.891,
            0.56372,
            1.01113,
            -0.11441,
            1.07168,
            0.62049,
            0.67705,
            0.09141,
            0.70055,
            1.30411,
            0.59709,
            -0.11441,
            -0.06667,
            0.12472,
            0.14963,
            0.13418,
            0.06823,
            0.56015,
            0.56015,
            0.42866,
            4.6282,
            4.43149,
            4.57757,
            0.42866,
            1.12508,
            0.02028,
            -5.25956,
            -5.25838,
            -5.27499,
            -5.19486,
            -5.63674,
            -4.51499,
            0.88902,
            0.65291,
            0.70829,
            0.78296,
            0.57395,
            0.81792,
            0.7706,
            0.7706,
            0.70926,
            -5.63674,
            -5.63674,
            -4.51499,
            0.62415,
            0.95002,
            0.86599,
            0.86599,
            2.57874,
            2.57874,
            2.92607,
            0.83175,
            0.56842,
            0.83175,
            1.35491
          ],
          [
            22.22567,
            15.27105,
            22.22567,
            22.22567,
            22.22567,
            32.51667,
            32.48741,
            28.25115,
            31.59637,
            29.46482,
            29.46482,
            28.25115,
            28.24864,
            27.47306,
            19.22384,
            28.25115,
            28.25115,
            28.25115,
            28.39878,
            -7.31794,
            12.95219,
            12.89349,
            12.86667,
            12.95795,
            12.917,
            12.983,
            12.92929,
            12.8,
            18.81667,
            18.81667,
            18.81667,
            18.81667,
            18.67919,
            18.12212,
            18.12212,
            18.8744,
            18.31977,
            15.30559,
            12.86667,
            13.1,
            13.1,
            11.95,
            11.95,
            11.95,
            11.88333,
            11.94907,
            11.94907,
            9.50627,
            27.96352,
            12.725,
            12.86667,
            32.29835,
            31.71331,
            32.25334,
            30.65154,
            30.56905,
            32.19997,
            31.71168,
            32.42975,
            13.58333,
            14.70635,
            13.03386,
            13.92133,
            12.84739,
            13.95211,
            14.37567,
            14.10658,
            14.37774,
            14.28902,
            14.21818,
            14.15543,
            14.17743,
            14.70635,
            14.37567,
            14.5,
            14.22778,
            14.43731,
            14.20981,
            14.41997,
            14.65732,
            14.65733,
            14.69668,
            28.45036,
            28.7054,
            28.39878,
            14.69668,
            14.9158,
            14.88925,
            21.40954,
            21.40981,
            21.41121,
            21.46034,
            21.37481,
            21.62685,
            30.35598,
            29.9823,
            30.01055,
            30.03965,
            30.03318,
            30.13119,
            30.13041,
            30.13041,
            30.06739,
            21.37481,
            21.37481,
            21.62685,
            32.73669,
            31.06358,
            30.92654,
            30.92654,
            27.27105,
            27.27105,
            27.449,
            32.58253,
            33.21263,
            32.58253,
            32.42471
          ],
          [
            280,
            280,
            280,
            280,
            280,
            151,
            151,
            151,
            151,
            151,
            151,
            151,
            151,
            151,
            1,
            22,
            22,
            22,
            22,
            0,
            30,
            30,
            30,
            30,
            30,
            30,
            30,
            30,
            250,
            250,
            250,
            250,
            250,
            250,
            250,
            250,
            250,
            250,
            21,
            21,
            21,
            45,
            45,
            45,
            45,
            45,
            45,
            45,
            45,
            45,
            45,
            224,
            224,
            224,
            224,
            224,
            224,
            224,
            224,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            97,
            128,
            128,
            128,
            128,
            128,
            128,
            128,
            29,
            29,
            29,
            7,
            7,
            7,
            10,
            10,
            10,
            186,
            186,
            186,
            186,
            186,
            186,
            39,
            39,
            39,
            39,
            39,
            39,
            39,
            39,
            39,
            15,
            15,
            15,
            1,
            4,
            4,
            4,
            13,
            13,
            13,
            3,
            3,
            3,
            3
          ],
          [
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1976,
            1977,
            1979,
            1979,
            1979,
            1979,
            1994,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1995,
            1996,
            1996,
            1996,
            1997,
            1997,
            1997,
            1997,
            1997,
            1997,
            1997,
            1997,
            1997,
            1997,
            2001,
            2001,
            2001,
            2001,
            2001,
            2001,
            2001,
            2001,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2002,
            2003,
            2003,
            2003,
            2003,
            2003,
            2003,
            2003,
            2003,
            2003,
            2003,
            2004,
            2004,
            2004,
            2005,
            2005,
            2005,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2007,
            2009,
            2009,
            2009,
            2011,
            2012,
            2012,
            2012,
            2012,
            2012,
            2012,
            2012,
            2012,
            2012,
            2012
          ],
          [
            '1976-10-24',
            '1976-10-24',
            '1976-10-24',
            '1976-10-24',
            '1976-10-24',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1976-11-25',
            '1977-06-01',
            '1979-10-06',
            '1979-10-06',
            '1979-10-06',
            '1979-10-06',
            '1994-11-24',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-02-09',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1995-07-16',
            '1996-03-03',
            '1996-03-03',
            '1996-03-03',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '1997-01-18',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2001-01-09',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2002-03-18',
            '2003-04-01',
            '2003-04-01',
            '2003-04-01',
            '2003-04-01',
            '2003-04-01',
            '2003-04-01',
            '2003-04-01',
            '2003-12-02',
            '2003-12-02',
            '2003-12-02',
            '2004-06-26',
            '2004-06-26',
            '2004-06-26',
            '2005-05-18',
            '2005-05-18',
            '2005-05-18',
            '2007-11-01',
            '2007-11-01',
            '2007-11-01',
            '2007-11-01',
            '2007-11-01',
            '2007-11-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2007-12-01',
            '2009-01-01',
            '2009-01-01',
            '2009-01-01',
            '2011-05-06',
            '2012-08-15',
            '2012-08-15',
            '2012-08-15',
            '2012-10-11',
            '2012-10-11',
            '2012-10-11',
            '2012-11-17',
            '2012-11-17',
            '2012-11-17',
            '2012-11-17'
          ],
          [
            280,
            560,
            840,
            1120,
            1400,
            1551,
            1702,
            1853,
            2004,
            2155,
            2306,
            2457,
            2608,
            2759,
            2760,
            2782,
            2804,
            2826,
            2848,
            2848,
            2878,
            2908,
            2938,
            2968,
            2998,
            3028,
            3058,
            3088,
            3338,
            3588,
            3838,
            4088,
            4338,
            4588,
            4838,
            5088,
            5338,
            5588,
            5609,
            5630,
            5651,
            5696,
            5741,
            5786,
            5831,
            5876,
            5921,
            5966,
            6011,
            6056,
            6101,
            6325,
            6549,
            6773,
            6997,
            7221,
            7445,
            7669,
            7893,
            7990,
            8087,
            8184,
            8281,
            8378,
            8475,
            8572,
            8669,
            8766,
            8863,
            8960,
            9057,
            9154,
            9282,
            9410,
            9538,
            9666,
            9794,
            9922,
            10050,
            10079,
            10108,
            10137,
            10144,
            10151,
            10158,
            10168,
            10178,
            10188,
            10374,
            10560,
            10746,
            10932,
            11118,
            11304,
            11343,
            11382,
            11421,
            11460,
            11499,
            11538,
            11577,
            11616,
            11655,
            11670,
            11685,
            11700,
            11701,
            11705,
            11709,
            11713,
            11726,
            11739,
            11752,
            11755,
            11758,
            11761,
            11764
          ]
        ],
        'valuessrc': 'public.health:8:FUZCLGLU5J99NX6NF967TFB5NVLORCCM,D45CYI16U3WOI2O3XO9TAY9L4JLTXNNZ,C7FAHM86DBPHBJ4J4K3WWSHBF5MCKZ2I,EPEUMNJ5RIVWACL64H72CYDLLJUO3JD0,06RHDR5X6NYIJ8LDMEK3VUY500N41LJP,ATRNPV39SL7NPNEOT83LPXN81FHWNSXW,NR07T3YPBHIJ633MLJ8XYP2DOC1ZRV4Y,TLY99YKQ88PRJOWP4OOWMCXA0P112RW4*'
      },
      'header': {
        'fill': {
          'color': [
            [
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Zaire',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Ivory Coast',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Zaire',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Bundibugyo',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan',
              'Ebola Sudan'
            ]
          ],
          'colorsrc': 'public.health:8:D45CYI16U3WOI2O3XO9TAY9L4JLTXNNZ*'
        },
        'font': {
          'color': 'rgb(255, 255, 255)'
        },
        'line': {
          'color': 'rgb(200, 212, 227)'
        },
        'values': [
          'Location',
          'Virus',
          'Lat',
          'Long',
          'Deaths',
          'Year Outbreak Ended',
          'Outbreak Date',
          'Cumulative Sum - Deaths'
        ],
        'valuessrc': 'public.health:8:0be48f'
      },
      'mode': 'markers',
      'type': 'table',
      'uid': '0cc74f'
    }
  ],
  'frames': [],
  'layout': {
    'autosize': true,
    'breakpoints': [],
    'font': {
      'family': 'Raleway'
    },
    'hovermode': 'closest',
    'margin': {
      'b': 0,
      'l': 0,
      'pad': 0,
      'r': 0,
      't': 0
    },
    'title': '',
    'titlefont': {
      'family': 'Raleway'
    }
  }
}

const ebola2 = {
  'data': [
    {
      'uid': '3c5ce2',
      'ysrc': 'public.health:8:06RHDR5X6NYIJ8LDMEK3VUY500N41LJP',
      'xsrc': 'public.health:8:NR07T3YPBHIJ633MLJ8XYP2DOC1ZRV4Y',
      'mode': 'markers',
      'marker': {
        'colorsrc': 'public.health:8:06RHDR5X6NYIJ8LDMEK3VUY500N41LJP',
        'autocolorscale': false,
        'cmin': 0,
        'colorscale': [
          [
            0,
            'rgb(10,10,10)'
          ],
          [
            0.35,
            'rgb(67,67,67)'
          ],
          [
            0.5,
            'rgb(114,114,114)'
          ],
          [
            0.6,
            'rgb(178,178,178)'
          ],
          [
            0.7,
            'rgb(214,214,214)'
          ],
          [
            1,
            'rgb(240,240,240)'
          ]
        ],
        'color': [
          280,
          280,
          280,
          280,
          280,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          1,
          22,
          22,
          22,
          22,
          0,
          30,
          30,
          30,
          30,
          30,
          30,
          30,
          30,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          21,
          21,
          21,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          224,
          224,
          224,
          224,
          224,
          224,
          224,
          224,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          128,
          128,
          128,
          128,
          128,
          128,
          128,
          29,
          29,
          29,
          7,
          7,
          7,
          10,
          10,
          10,
          186,
          186,
          186,
          186,
          186,
          186,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          15,
          15,
          15,
          1,
          4,
          4,
          4,
          13,
          13,
          13,
          3,
          3,
          3,
          3
        ],
        'reversescale': true,
        'cauto': true,
        'line': {
          'width': 2
        },
        'cmax': 280,
        'size': 10
      },
      'textsrc': 'public.health:8:FUZCLGLU5J99NX6NF967TFB5NVLORCCM',
      'text': [
        '30km from Yambuku',
        '\'\'Ngaliema hospital, Kinshasa\'\'',
        '120km from Yambuku (Bumba Zone 55/250 villages affected)',
        'Yambuku village (secondary)',
        'Yambuku village (index)',
        'Khartoum hospital',
        'Omdurman hospital',
        'Nzara (Cotton Factory)',
        'Juba hospital',
        'Maridi township',
        'Maridi General Hospital',
        'Nzara township',
        'Nzara hospital',
        'Tembura (Tambura in GMs)',
        'Bonduni village (20km east of Tanda)',
        'Nzara town',
        'Nzara hospital',
        '15km radius around Nzara',
        '15km radius around Yambio',
        'Tai National Park',
        'Mayela',
        'Ekobakoba',
        'Makokou general hospital',
        'Etakaniabe',
        'Andock',
        'Mekouka',
        'Mekouka and Andock mining camps',
        'Minkebe',
        'Mwembe (15km from Kikwit)',
        'Kikwit',
        'Kikwit 2 maternity hospital',
        'Kikwit general hospital',
        'Kikwit subregion',
        'Mosango hospital',
        'Mosango town',
        '150km from Kikwit within Kwilu district',
        '150km from Kikwit within Kwango district',
        'Kinshasa hospital',
        'Makokou general hospital',
        'Mayibout 2 (index)',
        'Mayibout 2 (secondary)',
        'Logging camp nr Booue (index 1)',
        'Logging camp nr Booue (index 2)',
        'Logging camp nr Booue (index 3)',
        'Balimba village (sp. Balemba in GE)',
        'Booue',
        'Around Booue',
        'Libreville',
        'Johannesburg (South Africa)',
        'Lastourville',
        'Makokou general hospital',
        'Gulu regional referral hospital',
        'Masindi hospital',
        'Lacor Hospital',
        'Mbarara hospital',
        'Mbarara district',
        'Rwot-Obilo',
        'Masindi district',
        'Gulu district',
        '\'\'Franceville, Mpassa district, Gabon\'\'',
        'Mbomo district (ROC)',
        '\'\'Ivindo Department, Gabon\'\'',
        '\'\'Zadie Department, Gabon\'\'',
        '\'\'Makokou Regional Hopsital, Ivindo district, Gabon\'\'',
        '\'\'Mekambo health center, La Zadie district, Gabon\'\'',
        'Kelle district (ROC)',
        'Etakangaye',
        '\'\'Oloba, Mbomo district\'\'',
        'Ekata',
        '\'\'Entsiami, Abolo, Ambomi\'\'',
        'Memdemba',
        'Grand Etoumbi',
        'Mbomo district',
        'Kelle health district',
        'Kelle health center',
        'Entsiami health center',
        '\'\'Site 2  (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Yembelangoye village (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Mvoula camp (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Mbandza forest near village (Mbomo district, Cuvette Ouest)\'\'',
        'Mbandza village',
        'Mbomo village',
        'Yambio county',
        'Forest 40km South of Yambio town',
        'Yambio town',
        'Mbomo',
        'Odzala National Park (Etoumbi)',
        'Etoumbi',
        'Bamoukamba 2 (index)',
        'Bamoukamba 2 (secondary)',
        'Ndongo 2',
        'From Ndongo 2 to Kampungu',
        'Luebo health zone',
        'Mweka health zone',
        'Karugutu subcountry',
        'Bubandi subcountry',
        'Busaru subcountry',
        'Bubukwanga subcountry (sp. Bukwanga in GE)',
        'Harugali subcountry',
        'Kasitu subcountry',
        'Kabango village (secondary)',
        '\'\'Kabango village (Kasitu subcounty, Bundibugyo district) (index)\'\'',
        'Bundibungyo town council subcountry',
        'Luebo health zone (index)',
        'Luebo health zone (secondary)',
        'Mweka health zone',
        'Nakisamata village (Luwero District)',
        'Kibaale district',
        '\'\'Nyanswiga village, Nyamarunda, Buyanja  (Kibaale District) (index)\'\'',
        'Nyanswiga village (secondary)',
        'Isiro health zone (index)',
        'Isiro health zone (secondary)',
        'Viadana health zone',
        'Luwero district (secondary)',
        'Jinja district',
        'Luwero district (index)',
        'Nakasongola district'
      ],
      'y': [
        280,
        280,
        280,
        280,
        280,
        151,
        151,
        151,
        151,
        151,
        151,
        151,
        151,
        151,
        1,
        22,
        22,
        22,
        22,
        0,
        30,
        30,
        30,
        30,
        30,
        30,
        30,
        30,
        250,
        250,
        250,
        250,
        250,
        250,
        250,
        250,
        250,
        250,
        21,
        21,
        21,
        45,
        45,
        45,
        45,
        45,
        45,
        45,
        45,
        45,
        45,
        224,
        224,
        224,
        224,
        224,
        224,
        224,
        224,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        97,
        128,
        128,
        128,
        128,
        128,
        128,
        128,
        29,
        29,
        29,
        7,
        7,
        7,
        10,
        10,
        10,
        186,
        186,
        186,
        186,
        186,
        186,
        39,
        39,
        39,
        39,
        39,
        39,
        39,
        39,
        39,
        15,
        15,
        15,
        1,
        4,
        4,
        4,
        13,
        13,
        13,
        3,
        3,
        3,
        3
      ],
      'x': [
        '1976-10-24',
        '1976-10-24',
        '1976-10-24',
        '1976-10-24',
        '1976-10-24',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1976-11-25',
        '1977-06-01',
        '1979-10-06',
        '1979-10-06',
        '1979-10-06',
        '1979-10-06',
        '1994-11-24',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-02-09',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1995-07-16',
        '1996-03-03',
        '1996-03-03',
        '1996-03-03',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '1997-01-18',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2001-01-09',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2002-03-18',
        '2003-04-01',
        '2003-04-01',
        '2003-04-01',
        '2003-04-01',
        '2003-04-01',
        '2003-04-01',
        '2003-04-01',
        '2003-12-02',
        '2003-12-02',
        '2003-12-02',
        '2004-06-26',
        '2004-06-26',
        '2004-06-26',
        '2005-05-18',
        '2005-05-18',
        '2005-05-18',
        '2007-11-01',
        '2007-11-01',
        '2007-11-01',
        '2007-11-01',
        '2007-11-01',
        '2007-11-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2007-12-01',
        '2009-01-01',
        '2009-01-01',
        '2009-01-01',
        '2011-05-06',
        '2012-08-15',
        '2012-08-15',
        '2012-08-15',
        '2012-10-11',
        '2012-10-11',
        '2012-10-11',
        '2012-11-17',
        '2012-11-17',
        '2012-11-17',
        '2012-11-17'
      ],
      'type': 'scatter',
      'name': 'OB_DEATH'
    }
  ],
  'layout': {
    'autosize': true,
    'yaxis': {
      'range': [
        -22.04136090727152,
        302.0413609072715
      ],
      'title': '',
      'type': 'linear',
      'autorange': true,
      'fixedrange': true
    },
    'title': '',
    'xaxis': {
      'range': [
        '1974-05-16 09:03:55.8079',
        '2015-04-27 14:56:04.1921'
      ],
      'title': '',
      'type': 'date',
      'autorange': true,
      'fixedrange': true
    },
    'hovermode': 'closest',
    'margin': {
      'r': 0,
      'b': 40,
      'pad': 0,
      'l': 40,
      't': 0
    }
  }
}

const ebola3 = {
  'data': [
    {
      'name': 'LONG',
      'text': [
        '30km from Yambuku',
        '\'\'Ngaliema hospital, Kinshasa\'\'',
        '120km from Yambuku (Bumba Zone 55/250 villages affected)',
        'Yambuku village (secondary)',
        'Yambuku village (index)',
        'Khartoum hospital',
        'Omdurman hospital',
        'Nzara (Cotton Factory)',
        'Juba hospital',
        'Maridi township',
        'Maridi General Hospital',
        'Nzara township',
        'Nzara hospital',
        'Tembura (Tambura in GMs)',
        'Bonduni village (20km east of Tanda)',
        'Nzara town',
        'Nzara hospital',
        '15km radius around Nzara',
        '15km radius around Yambio',
        'Tai National Park',
        'Mayela',
        'Ekobakoba',
        'Makokou general hospital',
        'Etakaniabe',
        'Andock',
        'Mekouka',
        'Mekouka and Andock mining camps',
        'Minkebe',
        'Mwembe (15km from Kikwit)',
        'Kikwit',
        'Kikwit 2 maternity hospital',
        'Kikwit general hospital',
        'Kikwit subregion',
        'Mosango hospital',
        'Mosango town',
        '150km from Kikwit within Kwilu district',
        '150km from Kikwit within Kwango district',
        'Kinshasa hospital',
        'Makokou general hospital',
        'Mayibout 2 (index)',
        'Mayibout 2 (secondary)',
        'Logging camp nr Booue (index 1)',
        'Logging camp nr Booue (index 2)',
        'Logging camp nr Booue (index 3)',
        'Balimba village (sp. Balemba in GE)',
        'Booue',
        'Around Booue',
        'Libreville',
        'Johannesburg (South Africa)',
        'Lastourville',
        'Makokou general hospital',
        'Gulu regional referral hospital',
        'Masindi hospital',
        'Lacor Hospital',
        'Mbarara hospital',
        'Mbarara district',
        'Rwot-Obilo',
        'Masindi district',
        'Gulu district',
        '\'\'Franceville, Mpassa district, Gabon\'\'',
        'Mbomo district (ROC)',
        '\'\'Ivindo Department, Gabon\'\'',
        '\'\'Zadie Department, Gabon\'\'',
        '\'\'Makokou Regional Hopsital, Ivindo district, Gabon\'\'',
        '\'\'Mekambo health center, La Zadie district, Gabon\'\'',
        'Kelle district (ROC)',
        'Etakangaye',
        '\'\'Oloba, Mbomo district\'\'',
        'Ekata',
        '\'\'Entsiami, Abolo, Ambomi\'\'',
        'Memdemba',
        'Grand Etoumbi',
        'Mbomo district',
        'Kelle health district',
        'Kelle health center',
        'Entsiami health center',
        '\'\'Site 2  (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Yembelangoye village (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Mvoula camp (Kullu district, Cuvette Ouest)\'\'',
        '\'\'Mbandza forest near village (Mbomo district, Cuvette Ouest)\'\'',
        'Mbandza village',
        'Mbomo village',
        'Yambio county',
        'Forest 40km South of Yambio town',
        'Yambio town',
        'Mbomo',
        'Odzala National Park (Etoumbi)',
        'Etoumbi',
        'Bamoukamba 2 (index)',
        'Bamoukamba 2 (secondary)',
        'Ndongo 2',
        'From Ndongo 2 to Kampungu',
        'Luebo health zone',
        'Mweka health zone',
        'Karugutu subcountry',
        'Bubandi subcountry',
        'Busaru subcountry',
        'Bubukwanga subcountry (sp. Bukwanga in GE)',
        'Harugali subcountry',
        'Kasitu subcountry',
        'Kabango village (secondary)',
        '\'\'Kabango village (Kasitu subcounty, Bundibugyo district) (index)\'\'',
        'Bundibungyo town council subcountry',
        'Luebo health zone (index)',
        'Luebo health zone (secondary)',
        'Mweka health zone',
        'Nakisamata village (Luwero District)',
        'Kibaale district',
        '\'\'Nyanswiga village, Nyamarunda, Buyanja  (Kibaale District) (index)\'\'',
        'Nyanswiga village (secondary)',
        'Isiro health zone (index)',
        'Isiro health zone (secondary)',
        'Viadana health zone',
        'Luwero district (secondary)',
        'Jinja district',
        'Luwero district (index)',
        'Nakasongola district'
      ],
      'lon': [
        22.22567,
        15.27105,
        22.22567,
        22.22567,
        22.22567,
        32.51667,
        32.48741,
        28.25115,
        31.59637,
        29.46482,
        29.46482,
        28.25115,
        28.24864,
        27.47306,
        19.22384,
        28.25115,
        28.25115,
        28.25115,
        28.39878,
        -7.31794,
        12.95219,
        12.89349,
        12.86667,
        12.95795,
        12.917,
        12.983,
        12.92929,
        12.8,
        18.81667,
        18.81667,
        18.81667,
        18.81667,
        18.67919,
        18.12212,
        18.12212,
        18.8744,
        18.31977,
        15.30559,
        12.86667,
        13.1,
        13.1,
        11.95,
        11.95,
        11.95,
        11.88333,
        11.94907,
        11.94907,
        9.50627,
        27.96352,
        12.725,
        12.86667,
        32.29835,
        31.71331,
        32.25334,
        30.65154,
        30.56905,
        32.19997,
        31.71168,
        32.42975,
        13.58333,
        14.70635,
        13.03386,
        13.92133,
        12.84739,
        13.95211,
        14.37567,
        14.10658,
        14.37774,
        14.28902,
        14.21818,
        14.15543,
        14.17743,
        14.70635,
        14.37567,
        14.5,
        14.22778,
        14.43731,
        14.20981,
        14.41997,
        14.65732,
        14.65733,
        14.69668,
        28.45036,
        28.7054,
        28.39878,
        14.69668,
        14.9158,
        14.88925,
        21.40954,
        21.40981,
        21.41121,
        21.46034,
        21.37481,
        21.62685,
        30.35598,
        29.9823,
        30.01055,
        30.03965,
        30.03318,
        30.13119,
        30.13041,
        30.13041,
        30.06739,
        21.37481,
        21.37481,
        21.62685,
        32.73669,
        31.06358,
        30.92654,
        30.92654,
        27.27105,
        27.27105,
        27.449,
        32.58253,
        33.21263,
        32.58253,
        32.42471
      ],
      'textsrc': 'public.health:8:FUZCLGLU5J99NX6NF967TFB5NVLORCCM',
      'lat': [
        2.82536,
        -4.31464,
        2.82547,
        2.82535,
        2.82535,
        15.56667,
        15.64228,
        4.63912,
        4.82768,
        4.91599,
        4.91599,
        4.63912,
        4.64247,
        5.60639,
        2.88874,
        4.639,
        4.639,
        4.63912,
        4.57757,
        5.86442,
        0.61618,
        0.56329,
        0.56667,
        0.53304,
        1.483,
        1.4,
        1.44201,
        1.76667,
        -5.03334,
        -5.03333,
        -5.03333,
        -5.03333,
        -4.60873,
        -4.88687,
        -4.88687,
        -4.93064,
        -5.88291,
        -4.30889,
        0.56667,
        1.11667,
        1.11667,
        0.1,
        0.1,
        0.1,
        0.11667,
        -0.09363,
        -0.09363,
        0.39478,
        -26.17673,
        -0.81832,
        0.56667,
        2.77768,
        1.68537,
        2.76761,
        -0.61158,
        -0.56762,
        2.94998,
        1.74679,
        2.83664,
        -1.63333,
        0.59709,
        0.66543,
        0.891,
        0.56372,
        1.01113,
        -0.11441,
        1.07168,
        0.62049,
        0.67705,
        0.09141,
        0.70055,
        1.30411,
        0.59709,
        -0.11441,
        -0.06667,
        0.12472,
        0.14963,
        0.13418,
        0.06823,
        0.56015,
        0.56015,
        0.42866,
        4.6282,
        4.43149,
        4.57757,
        0.42866,
        1.12508,
        0.02028,
        -5.25956,
        -5.25838,
        -5.27499,
        -5.19486,
        -5.63674,
        -4.51499,
        0.88902,
        0.65291,
        0.70829,
        0.78296,
        0.57395,
        0.81792,
        0.7706,
        0.7706,
        0.70926,
        -5.63674,
        -5.63674,
        -4.51499,
        0.62415,
        0.95002,
        0.86599,
        0.86599,
        2.57874,
        2.57874,
        2.92607,
        0.83175,
        0.56842,
        0.83175,
        1.35491
      ],
      'mode': 'markers',
      'marker': {
        'colorsrc': 'public.health:8:06RHDR5X6NYIJ8LDMEK3VUY500N41LJP',
        'autocolorscale': false,
        'cmin': 0,
        'colorscale': [
          [
            0,
            'rgb(221, 42, 145)'
          ],
          [
            0.35,
            'rgb(177, 77, 236)'
          ],
          [
            0.5,
            'rgb(118, 117, 237)'
          ],
          [
            0.6,
            'rgb(46, 142, 191)'
          ],
          [
            0.7,
            'rgb(11, 152, 121)'
          ],
          [
            1,
            'rgb(19, 152, 99)'
          ]
        ],
        'color': [
          280,
          280,
          280,
          280,
          280,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          151,
          1,
          22,
          22,
          22,
          22,
          0,
          30,
          30,
          30,
          30,
          30,
          30,
          30,
          30,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          250,
          21,
          21,
          21,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          45,
          224,
          224,
          224,
          224,
          224,
          224,
          224,
          224,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          97,
          128,
          128,
          128,
          128,
          128,
          128,
          128,
          29,
          29,
          29,
          7,
          7,
          7,
          10,
          10,
          10,
          186,
          186,
          186,
          186,
          186,
          186,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          39,
          15,
          15,
          15,
          1,
          4,
          4,
          4,
          13,
          13,
          13,
          3,
          3,
          3,
          3
        ],
        'symbol': 'circle',
        'reversescale': true,
        'colorbar': {
          'y': 0.5,
          'x': 1.02,
          'title': 'Deaths per<br>Outbreak',
          'len': 0.8,
          'thickness': 20
        },
        'cauto': true,
        'showscale': true,
        'line': {
          'color': 'rgb(255, 255, 255)',
          'width': 0.5
        },
        'cmax': 280,
        'size': 5
      },
      'latsrc': 'public.health:8:C7FAHM86DBPHBJ4J4K3WWSHBF5MCKZ2I',
      'type': 'scattergeo',
      'lonsrc': 'public.health:8:EPEUMNJ5RIVWACL64H72CYDLLJUO3JD0',
      'uid': '4fd8fd'
    }
  ],
  'layout': {
    'autosize': true,
    'title': '',
    'paper_bgcolor': 'rgb(242, 245, 250)',
    'geo': {
      'showland': true,
      'countrycolor': 'rgb(162, 177, 198)',
      'projection': {
        'scale': 2,
        'type': 'mercator'
      },
      'oceancolor': 'rgb(242, 245, 250)',
      'showlakes': false,
      'showocean': true,
      'landcolor': 'rgb(34, 34, 34)',
      'showrivers': false,
      'countrywidth': 0.2,
      'showcoastlines': true,
      'scope': 'africa',
      'resolution': 50
    },
    'dragmode': 'select',
    'mapbox': {
      'bearing': 0,
      'style': 'light',
      'pitch': 0,
      'zoom': 3,
      'center': {
        'lat': 1,
        'lon': 10
      }
    },
    'hovermode': 'closest',
    'font': {
      'family': 'Raleway'
    },
    'margin': {
      'r': 0,
      'b': 0,
      'pad': 0,
      'l': 0,
      't': 0
    }
  }
}

const ebola = {
  'version': 2,
  'layout': {
    'direction': 'vertical',
    'sizeUnit': 'px',
/*
    'second': {
      type: 'box',
      boxType: 'plot',
      figure: {
        data: [{
          type: 'scatter3d',
          x: [1, 2, 3],
          y: [1, 2, 3],
          z: [1, 2, 1]
        }]
      }
    },
*/
    'size': 1025,
    'type': 'split',
    'first': {
      'direction': 'vertical',
      'sizeUnit': 'px',
      'second': {
        'boxType': 'plot',
        'fileId': 'jackp:18198',
        'figure': ebola1,
        'type': 'box',
        'shareKey': null,
        'title': 'All Outbreak Data'
      },
      'size': 383,
      'type': 'split',
      'first': {
        'direction': 'horizontal',
        'sizeUnit': '%',
        'second': {
          'boxType': 'plot',
          'fileId': 'jackp:17875',
          'figure': ebola2,
          'type': 'box',
          'shareKey': null,
          'title': 'Deaths per Outbreak'
        },
        'size': 50,
        'type': 'split',
        'first': {
          'boxType': 'plot',
          'fileId': 'jackp:17874',
          'figure': ebola3,
          'type': 'box',
          'shareKey': null,
          'title': 'Outbreak Location'
        }
      }
    }
  },
  'settings': {
    'pageLayout': 'dashboard',
    'foregroundColor': '#506784',
    'boxBackgroundColor': '#ffffff',
    'links': [
      {
        'url': 'https://www.nature.com/articles/sdata201442#data-records',
        'title': 'Data Source: Nature'
      }
    ],
    'title': 'Ebola Outbreaks 1976-2013',
    'boxBorderColor': '#ffffff',
    'textBoxBackgroundColor': '#ffffff',
    'headerForegroundColor': '#506784',
    'headerFontWeight': '300',
    'fontFamily': 'Raleway',
    'showControlPanel': true,
    'enableCrossfilter': true,
    'headerFontSize': '2.2em',
    'backgroundColor': '#ffffff',
    'logoUrl': '',
    'textBoxFontColor': '#444',
    'textBoxFontSize': '1.6rem',
    'boxHeaderFontColor': '#506784',
    'boxHeaderBackgroundColor': '#ffffff',
    'headerBackgroundColor': '#FFFFFF'
  }
}

tap.test('should work for *plotly-dashboard-preview* component', t => {
  const outPath = path.join(ROOT_PATH, 'build', 'dashboard-preview.png')
  const ws = fs.createWriteStream(outPath)

  request({
    method: 'post',
    url: SERVER_URL + '/dashboard-preview',
    body: JSON.stringify(ebola || {
      settings: { backgroundColor: '#d3d3d3', width: 500, height: 500 },
      layout: {
        type: 'split',
        first: {
          type: 'split',
          first: {
            type: 'box',
            boxType: 'plot',
            figure: {
              data: [{
                y: [1, 2, 1]
              }]
            }
          },
          second: {
            type: 'box',
            boxType: 'plot',
            figure: {
              data: [{
                type: 'bar',
                y: [1, 2, 4]
              }]
            }
          }
        },
        second: {
          type: 'split',
          first: {
            type: 'box',
            boxType: 'plot',
            figure: {
              data: [{
                type: 'heatmap',
                z: [[1, 2, 4], [1, 2, 3]]
              }]
            }
          },
          second: {
            type: 'box',
            boxType: 'plot',
            figure: {
              data: [{
                type: 'scatter3d',
                x: [1, 2, 3],
                y: [1, 2, 3],
                z: [1, 2, 1]
              }]
            }
          }
        }
      }
    })
  })
  .on('error', t.fail)
  .pipe(ws)

  ws.on('error', t.fail)
  ws.on('finish', () => {
    t.ok(fileType(readChunk.sync(outPath, 0, 4100)).mime === 'image/png', 'png content')
    t.end()
  })
})

tap.test('should teardown', t => {
  app.stop()
    .catch(t.fail)
    .then(t.end)
})
